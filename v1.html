<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Basketball Scoreboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="/socket.io/socket.io.js"></script>
    <style>
        .team-logo {
            width: 80px;
            height: 80px;
        }
        .score {
            font-size: 4rem;
            font-weight: bold;
        }
        .game-time {
            font-size: 2rem;
            font-weight: bold;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
        }
        .player-stats {
            font-size: 0.9rem;
        }
        .nav-tabs .nav-link {
            color: #000;
        }
        .nav-tabs .nav-link.active {
            background-color: #2c3e50;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <!-- Scoreboard Header -->
        <div class="row align-items-center bg-light p-3 border border-3 rounded mb-4">
            <div class="col text-center">
                <h3>Team 1</h3>
                <div class="score">0</div>
            </div>
            <div class="col text-center">
                <div class="game-time mb-2">2ND HALF</div>
                <div class="game-time">00:00</div>
            </div>
            <div class="col text-center">
                <h3>Team 2</h3>
                <div class="score">0</div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
                <a class="nav-link active" href="#">Summary</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Box Score</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Play by Play</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Shot Chart</a>
            </li>
        </ul>

        <!-- Player Stats Table -->
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>Player</th>
                        <th>PTS</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Player Name</td>
                        <td>0</td>
                    </tr>
                    <!-- Add more rows as needed -->
                </tbody>
            </table>
        </div>

        <!-- Game Details -->
        <div class="mt-4 small text-muted">
            <span class="me-3">Competition: Basketball Game</span>
            <span class="me-3">Location: Game Arena</span>
            <span class="me-3">Game Details: Tip off: 7:00 PM</span>
            <span>Attendance: 0</span>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Connect to WebSocket server
        const socket = io();

        // DOM elements
        const team1Score = document.querySelector('#team1-score');
        const team2Score = document.querySelector('#team2-score');
        const gameTime = document.querySelector('#game-time');
        const period = document.querySelector('#period');
        const playerTable = document.querySelector('#player-table tbody');

        // Socket event listeners
        socket.on('gameState', (state) => {
            updateScoreboard(state);
        });

        socket.on('scoreUpdate', (state) => {
            updateScoreboard(state);
        });

        socket.on('timeUpdate', (state) => {
            updateScoreboard(state);
        });

        socket.on('playerUpdate', (state) => {
            updateScoreboard(state);
        });

        function updateScoreboard(state) {
            team1Score.textContent = state.team1.score;
            team2Score.textContent = state.team2.score;
            gameTime.textContent = state.gameTime;
            period.textContent = state.period;
            
            // Update player stats
            updatePlayerStats(state.team1.players, state.team2.players);
        }

        function updatePlayerStats(team1Players, team2Players) {
            playerTable.innerHTML = '';
            
            // Add team 1 players
            team1Players.forEach(player => {
                const row = createPlayerRow(player);
                playerTable.appendChild(row);
            });

            // Add team 2 players
            team2Players.forEach(player => {
                const row = createPlayerRow(player);
                playerTable.appendChild(row);
            });
        }

        function createPlayerRow(player) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${player.number}</td>
                <td>${player.name}</td>
                <td>${player.points}</td>
            `;
            return row;
        }

        // Example function to update score (for testing)
        function addPoints(team, points) {
            fetch('/api/updateScore', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ team, points }),
            });
        }
    </script>
</body>
</html>